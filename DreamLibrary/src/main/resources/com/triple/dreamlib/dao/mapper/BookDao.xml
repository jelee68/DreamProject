<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.triple.dreamlib.dao.BookDao">

  <select id="booklistDao" resultType="com.triple.dreamlib.dto.BookDto">
		select rownum, book_id, book_code, book_name, book_author, book_date, book_pub, book_in_date, book_imgPath
  		from book_tbl order by book_id asc
  </select>

  <select id="maxBookIdDao" resultType="com.triple.dreamlib.dto.MaxBookIdDto">
	select to_char((decode(max(substr(book_id,3,6)),null,0,max(substr(book_id,3,6))))+1,'000000') as book_id
	  from book_tbl where book_code = #{param1}
  </select>

  <select id="bookselDao" resultType="com.triple.dreamlib.dto.BookDto">
		select rownum, book_id, book_code, book_name, book_author, book_date, book_pub, book_in_date, book_imgPath
  		from book_tbl where book_id = #{param1} order by book_id asc
  </select>

  <select id="book_result1Dao" resultType="com.triple.dreamlib.dto.BookSearchDto">
	select rownum, book_id, book_name, book_author, book_pub, book_date, book_imgPath,
    	   decode(fun_bookstatus(book_id),null||0,'대출가능','대출중') as book_status 
	  from book_tbl where ${param1} like '%'|| #{param2} ||'%'  order by book_id asc
  </select>
	
  <select id="book_result2Dao" resultType="com.triple.dreamlib.dto.BookSearchDto">
	select rownum, book_id, book_name, book_author, book_pub, book_date, book_imgPath,
    	   decode(fun_bookstatus(book_id),null||0,'대출가능','대출중') as book_status 
	  from book_tbl where ${param1} like '%'|| #{param2} ||'%' 
	  				${param3} ${param4} like '%'|| #{param5} ||'%' 
	  order by book_id asc
  </select>
  
    <select id="book_result3Dao" resultType="com.triple.dreamlib.dto.BookSearchDto">
	select rownum, book_id, book_name, book_author, book_pub, book_date, book_imgPath,
    	    decode(fun_bookstatus(book_id),null||0,'대출가능','대출중') as book_status 
	  from book_tbl where ${param1} like '%'|| #{param2} ||'%' 
	  				${param3} ${param4} like '%'|| #{param5} ||'%'
	  				${param6} ${param7} like '%'|| #{param8} ||'%'
  </select>	

  <insert id="book_addDao">
  INSERT  INTO BOOK_TBL VALUES (#{param1},#{param2},#{param3},#{param4},#{param5},#{param6},sysdate,#{param7})
  </insert>	
  
   <update id="book_modifyDao">
    UPDATE BOOK_TBL SET BOOK_CODE = #{param1}, BOOK_NAME = #{param2}, 
           BOOK_AUTHOR = #{param3},	BOOK_DATE = #{param4}, BOOK_PUB = #{param5}
     WHERE BOOK_ID = #{param6}
  </update> 
  
  <delete id="book_deleteDao">
	DELETE FROM BOOK_TBL WHERE BOOK_ID = #{param1}
  </delete>  
  
</mapper>
